<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/projeto-worldpackers/src/assets/img/icon.ico"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Oswald:wght@200..700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="/projeto-worldpackers/src/assets/style/styles.css"
    />
    <title>Cadastro</title>
    <style>
      input:invalid {
        border-color: red;
      }
      input:valid {
        border-color: green;
      }
    </style>
  </head>
  <body class="h-screen bg-blue-100">
    <header class="bg-chalk pl-6 py-2">
      <nav>
        <div class="flex items-center justify-between" id="logo">
          <a href="/projeto-worldpackers/src/pages/index.html">
            <img
              src="/projeto-worldpackers/src/assets/img/seashellther.png"
              class="h-8"
              alt="Seashellter Logo"
            />
          </a>
          <div
            class="hidden md:flex md:flex-grow md:justify-center md:items-center text-gray text-sm"
          >
            <ul class="flex space-x-8">
              <li><a href="#" class="hover:text-ocre-light">Ajuda</a></li>
              <li>
                <a href="#" class="hover:text-ocre-light">Como funciona</a>
              </li>
              <li>
                <a href="#" class="hover:text-ocre-light">Seja um Anfitriao</a>
              </li>
            </ul>
          </div>
          <div class="md:hidden">
            <button
              id="menu-btn"
              class="text-gray hover:text-ocre-light focus:outline-none"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                ></path>
              </svg>
            </button>
          </div>
        </div>
        <div
          id="offcanvas-menu"
          class="hidden md:hidden fixed inset-0 bg-ocre-light bg-opacity-100 z-50"
        >
          <div class="flex justify-end p-4">
            <button
              id="close-btn"
              class="text-chalk hover:text-gray focus:outline-none"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>
          <ul
            class="flex flex-col items-center text-montserrat text-chalk mt-10 space-y-4"
          >
            <li><a href="#" class="hover:text-gray">Ajuda</a></li>
            <li><a href="#" class="hover:text-gray">Como funciona</a></li>
            <li><a href="#" class="hover:text-gray">Seja um anfitriao</a></li>
          </ul>
        </div>
      </nav>
    </header>
    <div class="flex justify-center items-center">
      <div
        class="justify-center bg-white bg-opacity-90 shadow-lg rounded-lg mt-4 py-3 px-8 max-w-md"
      >
        <h2 class="text-2xl font-bold font-oswald text-center mb-2 text-chalk">
          Entrar
        </h2>
        <div class="mb-6">
          <div class="flex justify-center space-x-4 mb-4">
            <button
              class="bg-blue-500 text-white px-2 py-1 rounded-md shadow hover:bg-blue-600 flex items-center text-sm"
            >
              <img
                src="/projeto-worldpackers/src/assets/img/fb.png"
                alt="facebook"
                class="w-4 h-4 mr-2"
              />
              <i class="fab fa-facebook-f"></i> Entrar com Facebook
            </button>
            <button
              class="bg-red-500 text-white px-2 py-2 rounded-md shadow hover:bg-red-600 flex items-center text-sm"
            >
              <img
                src="/projeto-worldpackers/src/assets/img/google.png"
                alt="facebook"
                class="w-4 h-4 mr-2"
              />
              <i class="fab fa-google mr-2"></i> Entrar com Google
            </button>
          </div>
          <hr class="border-t border-chalk my-3" />
          <p class="text-center text-chalk">Ou entre usando seu e-mail:</p>
        </div>
        <form id="registrationForm" class="space-y-3" novalidate>
          <div>
            <label for="email" class="block text-sm font-montserrat text-chalk"
              >E-mail</label
            >
            <input
              type="email"
              id="email"
              class="mt-1 block w-full px-2 py-1 border border-chalk text-chalk rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
              placeholder="E-mail"
              name="email"
              required
            />
            <span class="text-red-500 text-xs hidden" id="emailError"
              >Por favor, insira um e-mail válido.</span
            >
          </div>
          <div>
            <label
              for="password"
              class="block text-sm font-montserrat text-chalk"
              >Senha</label
            >
            <input
              type="password"
              id="password"
              class="mt-1 block w-full px-3 py-2 border border-chalk text-chalk rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
              placeholder="Senha"
              name="password"
              required
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=]).{8,}"
            />
            <span class="text-red-500 text-xs hidden" id="passwordError">
              <p>A senha deve ter pelo menos 8 caracteres</p>
              <ul class="list-disc ml-5">
                <li>Incluir uma letra maiúscula</li>
                <li>Incluir uma letra minúscula</li>
                <li>Incluir um número</li>
                <li>Incluir um caractere especial</li>
              </ul>
            </span>
          </div>
          <div class="flex items-center">
            <input
              type="checkbox"
              id="remember"
              class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
            />
            <label for="remember" class="ml-2 block text-sm text-chalk"
              >Lembrar</label
            >
            <a href="#" class="ml-auto text-sm text-blue-100 hover:underline"
              >Esqueceu sua senha?</a
            >
          </div>
          <div class="flex justify-between m-5">
            <button
              type="submit"
              class="bg-ocre-light text-white px-2 py-1 rounded-md shadow hover:bg-blue-100 text-sm"
            >
              Entrar
            </button>
            <button
              type="button"
              id="clearButton"
              class="bg-chalk text-white px-2 py-1 rounded-md shadow hover:bg-blue-100 text-sm"
            >
              Limpar
            </button>
          </div>
        </form>
        <div id="formDataContainer"></div>
      </div>
    </div>
    <script src="/projeto-worldpackers/src/assets/main/tailwind.config.js"></script>
    <script>
      $(document).ready(function () {
        function clearFormAndLocalStorage() {
          $("#registrationForm")[0].reset();
          localStorage.removeItem("formData");
          $("#formDataContainer").empty();
          $("#email").removeClass("invalid valid");
          $("#password").removeClass("invalid valid");
        }

        $("#clearButton").on("click", function () {
          clearFormAndLocalStorage();
        });

        $("#registrationForm").on("submit", async function (event) {
          event.preventDefault();

          let email = $("#email").val();
          let password = $("#password").val();

          async function verificarCredenciais(email, password) {
            try {
              const response = await fetch("http://localhost:3000/credentials");
              if (!response.ok) {
                throw new Error("Erro ao buscar credenciais do servidor");
              }

              const credentials = await response.json();
              const user = credentials.find(
                (cred) => cred.email === email && cred.password === password
              );

              return user ? true : false;
            } catch (error) {
              console.error("Erro ao verificar credenciais:", error);
              return false;
            }
          }

          localStorage.setItem("formData", JSON.stringify({ email, password }));

          try {
            const validCredentials = await verificarCredenciais(
              email,
              password
            );

            if (validCredentials) {
              alert(
                "Login bem-sucedido! Redirecionando para a página de busca."
              );
              window.location.href =
                "/projeto-worldpackers/src/pages/search.html";
            } else {
              alert(
                "Credenciais inválidas. Por favor, verifique seu email e senha."
              );
            }
          } catch (error) {
            console.error("Erro ao verificar credenciais:", error);
            alert("Ocorreu um erro ao verificar as credenciais.");
          }
        });

        $("#email").on("input", function () {
          if (this.validity.valid) {
            $(this).removeClass("invalid").addClass("valid");
          } else {
            $(this).removeClass("valid").addClass("invalid");
          }
        });

        $("#password").on("input", function () {
          if (this.validity.valid) {
            $(this).removeClass("invalid").addClass("valid");
          } else {
            $(this).removeClass("valid").addClass("invalid");
          }
        });
      });
    </script>
  </body>
</html>
